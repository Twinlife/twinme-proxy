user  nginx;
worker_processes  auto;

events {
    worker_connections  1024;
}

stream {
    map $ssl_preread_server_name $name {
        ws.skred.mobi                   skred-signaling-service;
        ws.twin.me                      twinme-signaling-service;
        default                         deny;
    }

    upstream twinme-signaling-service {
         server ws.twin.me:443;
    }
    upstream skred-signaling-service {
         server ws.skred.mobi:443;
    }
    upstream deny {
        server 127.0.0.1:9;
    }

    server {
        listen                443;
        proxy_pass            $name;
        ssl_preread           on;
        error_log             /dev/null;
        access_log            off;
     }
}
